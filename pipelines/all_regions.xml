<connection id="connection_1" host="{{ connection_1_host }}" port="{{ connection_1_port }}" username="{{ connection_1_username }}" database="{{ connection_1_database }}" password="{{ connection_1_password }}"></connection>

<task id="build_pokemon" schedule="*/2 * * * *"></task>

<python id="johto_core" handler="main" inputs="johto_conf">

from core import Pipeline
def main():
    p=Pipeline('pipelines/johto.xml')
    print(f'Pipeline Johto Started.....')
    p.run()
    return 0

</python>
<python id="sinnoh_core"  handler="main" inputs="sinnoh_conf">

from core import Pipeline
def main():
    p=Pipeline('pipelines/sinnoh.xml')
    print(f'Pipeline Sinnoh Started.....')
    p.run()
    return 0

</python>
<python id="kanto_core" handler="main" inputs="kanto_conf">

from core import Pipeline
def main():
    p=Pipeline('pipelines/kanto.xml')
    print(f'Pipeline Kanto Started.....')
    p.run()
    return 0

</python>
<sql id="all_regions" table="ALL_REGIONS" schema="POKEMON" database="RAW" connection="connection_1" materialization="truncate"  inputs="johto_core,sinnoh_core,kanto_core" schema_change="drop_and_recreate">

SELECT 
* 
FROM "POKEMON"."JOHTO_CORE"
UNION ALL
SELECT 
* 
FROM "POKEMON"."JOHTO_CORE"
UNION ALL 
SELECT 
* 
FROM "POKEMON"."JOHTO_CORE"

</sql>

<sql id="data_quality_test" connection="connection_1" inputs="all_regions">
SELECT * FROM "POKEMON"."ALL_REGIONS"
</sql>